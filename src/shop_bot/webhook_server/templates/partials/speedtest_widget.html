<div class="card">
  <div class="card-header d-flex justify-content-between align-items-center">
    <h3 class="card-title">Скорость интернета</h3>
    <form id="speedtest-form" action="{{ url_for('run_speedtest') }}" method="post">
      <button type="submit" class="btn btn-primary btn-sm" {% if status and status.test_in_progress %}disabled{% endif %}>
        {% if status and status.test_in_progress %}
          Тест выполняется...
        {% else %}
          Запустить тест
        {% endif %}
      </button>
    </form>
  </div>
  <div class="card-body">
    {% if error %}
      <div class="alert alert-danger" role="alert">{{ error }}</div>
    {% endif %}

    {% if results %}
      <div class="row g-3">
        <div class="col-4">
          <div class="subheader">Скачивание</div>
          <div class="h2">{{ results.download_speed }} <small class="text-secondary">Мбит/с</small></div>
        </div>
        <div class="col-4">
          <div class="subheader">Загрузка</div>
          <div class="h2">{{ results.upload_speed }} <small class="text-secondary">Мбит/с</small></div>
        </div>
        <div class="col-4">
          <div class="subheader">Пинг</div>
          <div class="h2">{{ results.ping }} <small class="text-secondary">мс</small></div>
        </div>
      </div>
      <div class="text-secondary small mt-2">
        Провайдер: {{ results.isp or '—' }}
        <span class="mx-2">•</span>
        Сервер: {{ results.server_name or '—' }}, {{ results.server_country or '' }}
        <span class="mx-2">•</span>
        Внешний IP: {{ results.external_ip or '—' }}
        <div class="mt-1">Время: {{ results.timestamp or '' }}</div>
      </div>
    {% else %}
      <p class="text-secondary mb-0">Нет данных. Нажмите "Запустить тест", чтобы измерить скорость соединения сервера.</p>
    {% endif %}
  </div>
</div>
